tinyMCE.importPluginLanguagePack("drupalbreak","en");var TinyMCE_drupalbreakPlugin={getInfo:function(){return {longname:"Drupal Teaser/Body Break",author:"Nathan Haug",authorurl:"http://www.quicksketch.org",infourl:"",version:"$Revision: 1.3 $"};},initInstance:function(_1){tinyMCE.importCSS(_1.getDoc(),tinyMCE.baseURL+"/plugins/drupalbreak/drupalbreak.css");},getControlHTML:function(_2){switch(_2){case "drupalbreak":return tinyMCE.getButtonHTML(_2,"lang_drupalbreak_desc","{$pluginurl}/images/drupalbreak.gif","mcedrupalbreak",false,"null");case "drupalpagebreak":var _3="tinyMCE.execInstanceCommand('{$editor_id}','mcedrupalpagebreak',true);return false;";return "<a href=\"javascript:"+_3+"\" onclick=\""+_3+"\" target=\"_self\" onmousedown=\"return false;\"><img id=\"{$editor_id}_drupalpagebreak\" src=\"{$pluginurl}/images/drupalpagebreak.gif\" title=\"{$lang_drupalpagebreak_desc}\" width=\"20\" height=\"20\" class=\"mceButtonNormal\" onmouseover=\"tinyMCE.switchClass(this,'mceButtonOver');\" onmouseout=\"tinyMCE.restoreClass(this);\" onmousedown=\"tinyMCE.restoreAndSwitchClass(this,'mceButtonDown');\" /></a>";}return "";},execCommand:function(_4,_5,_6,_7,_8){function getAttrib(_9,_a){return _9.getAttribute(_a)?_9.getAttribute(_a):"";}switch(_6){case "mcedrupalbreak":var _b="";var _c=new Array();var _d=tinyMCE.getInstanceById(_4);var _e=_d.getFocusElement();if(_e!=null&&_e.nodeName.toLowerCase()=="img"){_b=getAttrib(_e,"class");if(_b!="mce_plugin_drupalbreak_break"){return true;}action="update";}html=""+"<img src=\""+(tinyMCE.getParam("theme_href")+"/images/spacer.gif")+"\" "+" width=\"100%\" height=\"12px\" "+"alt=\"&lt;--break-&gt;\" title=\"&lt;--break--&gt;\" class=\"mce_plugin_drupalbreak_break\" />";tinyMCE.execInstanceCommand(_4,"mceInsertContent",false,html);return true;case "mcedrupalpagebreak":var _f="";var _10=new Array();var _11=tinyMCE.getInstanceById(_4);var _12=_11.getFocusElement();if(_12!=null&&_12.nodeName.toLowerCase()=="img"){_f=getAttrib(_12,"class");if(_f!="mce_plugin_drupalbreak_pagebreak"){return true;}action="update";}html=""+"<img src=\""+(tinyMCE.getParam("theme_href")+"/images/spacer.gif")+"\" "+" width=\"100%\" height=\"12px\" "+"alt=\"&lt;--pagebreak-&gt;\" title=\"&lt;--pagebreak--&gt;\" class=\"mce_plugin_drupalbreak_pagebreak\" />";tinyMCE.execInstanceCommand(_4,"mceInsertContent",false,html);return true;}return false;},cleanup:function(_13,_14){switch(_13){case "insert_to_editor":var _15=0;while((_15=_14.indexOf("<!--break-->",_15))!=-1){var _16=_14.substring(_15+12);_14=_14.substring(0,_15);_14+="<img src=\""+(tinyMCE.getParam("theme_href")+"/images/spacer.gif")+"\" ";_14+=" width=\"100%\" height=\"12px\" ";_14+="alt=\"&lt;--break-&gt;\" title=\"&lt;--break--&gt;\" class=\"mce_plugin_drupalbreak_break\" />";_14+=_16;_15++;}var _17=0;while((_17=_14.indexOf("<!--pagebreak-->",_17))!=-1){var _18=_14.substring(_17+16);_14=_14.substring(0,_17);_14+="<img src=\""+(tinyMCE.getParam("theme_href")+"/images/spacer.gif")+"\" ";_14+=" width=\"100%\" height=\"12px\" ";_14+="alt=\"&lt;--pagebreak-&gt;\" title=\"&lt;--pagebreak--&gt;\" class=\"mce_plugin_drupalbreak_pagebreak\" />";_14+=_18;_17++;}break;case "get_from_editor":var _19=-1;while((_19=_14.indexOf("<img",_19+1))!=-1){var _1a=_14.indexOf("/>",_19);var _1b=parseAttributes(_14.substring(_19+4,_1a));if(_1b["class"]=="mce_plugin_drupalbreak_break"){_1a+=2;var _1c="<!--break-->";chunkBefore=_14.substring(0,_19);chunkAfter=_14.substring(_1a);_14=chunkBefore+_1c+chunkAfter;}if(_1b["class"]=="mce_plugin_drupalbreak_pagebreak"){_1a+=2;var _1d="<!--pagebreak-->";chunkBefore=_14.substring(0,_19);chunkAfter=_14.substring(_1a);_14=chunkBefore+_1d+chunkAfter;}}break;}return _14;function parseAttributes(_1e){var _1f="";var _20="";var _21;var _22;var _23=new Array();var _24=new RegExp("^[ \n\r\t]+","g");if(_1e==null||_1e.length<2){return null;}_21=_22=false;for(var i=0;i<_1e.length;i++){var chr=_1e.charAt(i);if((chr=="\""||chr=="'")&&!_22){_22=true;}else{if((chr=="\""||chr=="'")&&_22){_22=false;var pos=_1f.lastIndexOf(" ");if(pos!=-1){_1f=_1f.substring(pos+1);}_23[_1f.toLowerCase()]=_20.substring(1).toLowerCase();_1f="";_20="";}else{if(!_24.test(chr)&&!_21&&!_22){_21=true;}}}if(chr=="="&&_21){_21=false;}if(_21){_1f+=chr;}if(_22){_20+=chr;}}return _23;}},handleNodeChange:function(_28,_29,_2a,_2b,_2c,_2d){function getAttrib(elm,_2f){return elm.getAttribute(_2f)?elm.getAttribute(_2f):"";}tinyMCE.switchClass(_28+"_drupalbreak_break","mceButtonNormal");tinyMCE.switchClass(_28+"_drupalbreak_pagebreak","mceButtonNormal");if(_29==null){return;}do{if(_29.nodeName.toLowerCase()=="img"&&getAttrib(_29,"class").indexOf("mce_plugin_drupalbreak_break")==0){tinyMCE.switchClass(_28+"_drupalbreak_break","mceButtonSelected");}if(_29.nodeName.toLowerCase()=="img"&&getAttrib(_29,"class").indexOf("mce_plugin_drupalbreak_pagebreak")==0){tinyMCE.switchClass(_28+"_drupalbreak_pagebreak","mceButtonSelected");}}while((_29=_29.parentNode));return true;}};tinyMCE.addPlugin("drupalbreak",TinyMCE_drupalbreakPlugin);